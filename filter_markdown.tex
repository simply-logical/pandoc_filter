%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% mlind %%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\mlind}[2][same]{%
\ifstrequal{#1}{same}{\verb|{{< indexer add '#2' idxdisplay='' >}}|}{\verb|{{< indexer add '#1' idxdisplay='#2' >}}|}%
}

\renewcommand{\mlindi}[2][same]{%
\ifstrequal{#1}{same}{\verb|{{< indexer add '#2' idxdisplay='' >}}|}{\verb|{{< indexer add '#2' idxdisplay='' idxsortkey='#1' >}}|}%
}

\renewcommand{\mlindii}[2]{%
\verb|{{< indexer add '#2' idxdisplay='#1 #2' idxnesting='#1' >}}|
}

\renewcommand{\mlindiii}[2]{%
\verb|{{< indexer add '#2' idxdisplay='#1' idxnesting='#1' >}}|
}

\renewcommand{\mlindiv}[2]{%
\verb|{{< indexer add '#1' idxdisplay='' >}} {{< indexer add '#2' idxdisplay='(#2)' idxsee='#1' >}}|
} 

\renewcommand{\mlindv}[2]{%
\verb|{{< indexer add '#1' idxdisplay='' idxsee='#2' >}} {{< indexer add '#2' >}}|
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% mldef %%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\mldef}[2][same]{%
\ifstrequal{#1}{same}{\verb|{{< definer '#2' defstyle=mldefstyle defindex='' idxstyle=defstyle >}}|}{\verb|{{< definer '#2' defstyle=mldefstyle defindex='#1' idxstyle=defstyle >}}|}%
}

\renewcommand{\mldefi}[2][same]{%
\ifstrequal{#1}{same}{\verb|{{< definer '#2' defstyle=mldefstyle defindex='' idxstyle=defstyle >}}|}{\verb|{{< definer '#2' defstyle=mldefstyle defindex='' idxsortkey='#1' idxstyle=defstyle >}}|}%
}

\renewcommand{\mldefii}[2]{%
\verb|{{< definer '#1 #2' defstyle=mldefstyle defindex='#2' idxnesting='#1' idxstyle=defstyle >}}|%
}

\renewcommand{\mldefiii}[2]{%
\verb|{{< definer '#1' defstyle=mldefstyle defindex='#2' idxnesting='#1' idxstyle=defstyle >}}|%
}

\renewcommand{\mldefiv}[2]{%
\verb|{{< definer '#1' defstyle=mldefstyle defindex='' idxstyle=defstyle >}} ({{< definer '#2' defstyle=mldefstyle defindex='' idxsee='#1' >}})|%
} % NB. doesn't seem to work if #1 is of the form term1!term2

\renewcommand{\mldefv}[2]{%
\verb|{{< definer '#1' defstyle=mldefstyle defindex='' idxsee='#2' >}} {{< indexer add '#2' idxstyle=defstyle >}}|%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% mlref %%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\mlref}[2][none]{%
#2 \verb|{{< indexer add '#2' >}}| \ifstrequal{#1}{none}{}{ in #1}%
}

\renewcommand{\mlrefi}[2][same]{%
#2 \ifstrequal{#1}{same}{\verb|{{< indexer add '#2' >}}|}{\verb|{{< indexer add '#1' >}}|}%
}

\renewcommand{\mlrefii}[2][none]{%
#2 \verb|{{< indexer add '#2' >}}| \ifstrequal{#1}{none}{}{ (#1)}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% person %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\person}[2]{%
#1 #2 \verb|{{< indexer add '#2' idxsuffix='#1' >}}|%
}

\renewcommand{\personii}[2]{%
#2 \verb|{{< indexer add '#2' idxsuffix='#1' >}}|%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% system %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\system}[2][machine learning systems]{%
#2 \verb|{{< indexer add '#1' idxnesting='#2' >}}| \verb|{{< indexer add '#2' idxsee='#1' >}}|%
}

\renewcommand{\systemi}[2][machine learning systems]{%
#2 \verb|{{< indexer add '#1' idxnesting='#2' >}}|%
}

\renewcommand{\systemii}[1]{%
#1%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% Prolog %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\Prolog}{\system[query languages]{Prolog}}
\renewcommand{\Prologi}{\systemi[query languages]{Prolog}}
\renewcommand{\Prologii}{\systemii{Prolog}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% lb/alg index %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\lbindex}[2]{%
\verb|{{< indexer add '#1' idxnesting='#2' >}}|%
}

\renewcommand{\algindex}[2]{%
\verb|{{< indexer add '#1 (#2)' >}}|%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% environments %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%\mldefn[index term]{label}{caption}{body}
\newcommand{\mldefn}[4][same]{
  \begin{definition}[#3]\label{def-#2}
    \subsection{#3}
    {#4}
  \end{definition}
  \ifstrequal{#1}{same}{\verb|{{< indexer add '#3' idxnesting='Definition [-@def-#2]' >}}|}{\ifstrequal{#1}{none}{}{\verb|{{< indexer add '#1' idxnesting='Definition [-@def-#2]' >}}|}}
}

%%%\mlthm[index term]{label}{caption}{body}
\newcommand{\mlthm}[4][same]{
  \begin{theorem}[#3]\label{thm-#2}
    \subsection{#3}
    {#4}
  \end{theorem}
  \ifstrequal{#1}{same}{\verb|{{< indexer add '#3' idxnesting='Theorem [-@thm-#2]' >}}|}{\ifstrequal{#1}{none}{}{\verb|{{< indexer add '#1' idxnesting='Theorem [-@thm-#2]' >}}|}}
}

%%%\mlex[index term]{label}{caption}{body}
\newcommand{\mlex}[4][same]{
  \begin{example}[#3]\label{exm-#2}
    \subsection{#3}
    {#4}
  \end{example}
  \ifstrequal{#1}{same}{\verb|{{< indexer add '#3' idxnesting='Example [-@exm-#2]' >}}|}{\ifstrequal{#1}{none}{}{\verb|{{< indexer add '#1' idxnesting='Example [-@exm-#2]' >}}|}}
}
